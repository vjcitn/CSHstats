<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>S4_inference: Definitions and exercises • CSHstats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="S4_inference: Definitions and exercises">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CSHstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.34</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/S1_probability.html">S1_probability: Definitions and exercises</a></li>
    <li><a class="dropdown-item" href="../articles/S1b_hyper.html">S1a: A look at the hypergeometric distribution</a></li>
    <li><a class="dropdown-item" href="../articles/S2_EDA.html">S2_EDA: Exploratory data analysis and visualization</a></li>
    <li><a class="dropdown-item" href="../articles/S2a_PCAelem.html">S2a: Elements of PCA</a></li>
    <li><a class="dropdown-item" href="../articles/S3_distclust.html">S3: Distances, clustering</a></li>
    <li><a class="dropdown-item" href="../articles/S4_hypothesis_testing.html">S4_inference: Definitions and exercises</a></li>
    <li><a class="dropdown-item" href="../articles/S5_linear_models.html">S5_inference: FDR, linear models, and GLMs</a></li>
    <li><a class="dropdown-item" href="../articles/S5a_lmdiagnostics.html">S5a: Diagnostics of a differential gene expression exercise</a></li>
    <li><a class="dropdown-item" href="../articles/S5b_nonlin.html">S5b: hypothesis testing in nonlinear regression</a></li>
    <li><a class="dropdown-item" href="../articles/S6_hca_onto.html">S6 HCA, ontologies, shiny</a></li>
    <li><a class="dropdown-item" href="../articles/S7_cnn.html">S7 Neural net concepts and applications</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vjcitn/CSHstats/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>S4_inference: Definitions and exercises</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">January 09, 2025</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/CSHstats/blob/HEAD/vignettes/S4_hypothesis_testing.Rmd" class="external-link"><code>vignettes/S4_hypothesis_testing.Rmd</code></a></small>
      <div class="d-none name"><code>S4_hypothesis_testing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<div class="section level3">
<h3 id="basic-concepts">Basic concepts<a class="anchor" aria-label="anchor" href="#basic-concepts"></a>
</h3>
<p>We are going to focus on the framework known “null hypothesis significance
testing”. A “null hypothesis” is typically denoted <span class="math inline">\(H_0\)</span> and expresses
a claim that often involves a <em>lack</em> of effect of an experimental intervention
on an outcome of interest. An “alternative hypothesis” is denoted
<span class="math inline">\(H_1\)</span>, and
it should express a specific measurable impact of an intervention.</p>
<p>In the case of our card deck from chapter S1, it would be typical to
postulate</p>
<ul>
<li>
<span class="math inline">\(H_0\)</span>: deck is fair, one card of each combination of face and suit</li>
<li>
<span class="math inline">\(H_1\)</span>: deck has been tampered with and has an excess of hearts</li>
</ul>
<p>Note that in this case, <span class="math inline">\(H_1\)</span> is fairly vague – it could be less specific,
referring only to lack of fairness. <span class="math inline">\(H_1\)</span> specifies which suit has an
excess representation in the deck, but it is not specific about how
severe the tampering has been.</p>
<p>In experimental design, it is important to have a clear view of</p>
<ul>
<li>
<em>sources of variation</em> in the outcome of interest, and</li>
<li>the <em>magnitude of effect</em> of intervention that is scientifically important.</li>
</ul>
<p>Only when both of these are in focus can we establish the
<em>operating characteristics</em> of our proposed experiment.</p>
<p>In the significance testing framework, we formalize operating characteristics
as probabilities of inferential error, described below.</p>
<p>Before we plunge in to more formalities, let’s recall how to work
with the deck of cards.</p>
<p>Here we create a fair deck:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/CSHstats" class="external-link">CSHstats</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in get(paste0(generic, ".", class), envir = get_method_env()) : </span></span>
<span><span class="co">##   object 'type_sum.accel' not found</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_deck.html">build_deck</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span></span>
<span><span class="co">##   ♡  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♢  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre>
<p>Now let’s create a severely biased deck:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bd</span> <span class="op">=</span> <span class="va">d</span>  <span class="co"># just a copy</span></span>
<span><span class="va">bd</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">bd</span><span class="op">[</span><span class="fl">19</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="va">bd</span><span class="op">[</span><span class="fl">20</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="va">bd</span><span class="op">[</span><span class="fl">21</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span></span>
<span><span class="co">##   ♡  1 1 1 3 2 2 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♢  1 1 1 1 1 0 0 0 0 1 1 1 1</span></span>
<span><span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre>
<p>Here are our tools for shuffling and drawing the top card:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">shuffle_deck</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">d</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">top_draw</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre></div>
<p>Let’s make a reproducible random draw:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">t1</span> <span class="op">=</span> <span class="fu">top_draw</span><span class="op">(</span><span class="va">bd</span><span class="op">)</span></span>
<span><span class="va">t1</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "3 ♣"</span></span></code></pre>
<p>Exercise: create a vector holding 100 draws from the biased deck.
Estimate the probability that the suit of the top card is diamond.
Use</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">diamond_sign</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="st">"\U2662"</span></span></code></pre></div>
<p>to test the suit of each draw. For example:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t1</span> <span class="op">==</span> <span class="fu">diamond_sign</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] FALSE</span></span></code></pre>
<p>Note: starting with set.seed(2345), the estimated probability of diamond as suit of top draw
that I found was 0.16.</p>
</div>
<div class="section level3">
<h3 id="the-fairness-hypothesis">The fairness hypothesis<a class="anchor" aria-label="anchor" href="#the-fairness-hypothesis"></a>
</h3>
<p>Let <span class="math inline">\(C_1\)</span> denote the suit of the top card revealed after a fair shuffle.
We can state a hypothesis about the fairness of the deck
under repeated draws of top card after shuffling as</p>
<p><span class="math display">\[
H_0: Pr(C_1 = \heartsuit) = Pr(C_1 = \diamondsuit) = Pr(C_1 = \clubsuit) = Pr(C_1 = \spadesuit) = 1/4
\]</span></p>
</div>
<div class="section level3">
<h3 id="operating-characteristics-type-i-and-type-ii-errors">Operating characteristics: Type I and Type II errors<a class="anchor" aria-label="anchor" href="#operating-characteristics-type-i-and-type-ii-errors"></a>
</h3>
<p>In a frequentist framework for statistical inference, we
define procedures for testing (null) hypotheses with specified
error probabilities.</p>
<ul>
<li><p>A <strong>Type I error</strong> occurs when the
null hypothesis is true but the test results in the assertion that it is
false. Traditionally we try to keep the probability of Type I errors
below 5%.</p></li>
<li><p>A <strong>Type II error</strong> occurs when the
null hypothesis is false but the test does not result in an
assertion that it is false. Traditionally we try to keep the
probability of Type II errors below 20%.</p></li>
<li><p>Synonyms: We often use <strong>size</strong> as synonymous with Type I error probability,
and <strong>power</strong> as one minus the Type II error probability</p></li>
</ul>
<div class="section level4">
<h4 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h4>
<p><strong>1: Propose a procedure for testing <span class="math inline">\(H_0: Pr(C_1 = \heartsuit) = 1/4\)</span>. Assume you have
the results of top card draws from N shuffles. What would such a procedure look like?</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="simulating-a-series-of-experiments-parameter-estimate">Simulating a series of experiments; parameter estimate<a class="anchor" aria-label="anchor" href="#simulating-a-series-of-experiments-parameter-estimate"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/CSHstats" class="external-link">CSHstats</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexkowa/EnvStats" class="external-link">EnvStats</a></span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_deck.html">build_deck</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">shuffle_deck</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">d</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">heart_sign</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="st">"\U2661"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4141</span><span class="op">)</span></span>
<span><span class="va">top_draw</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">N</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">mydat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">phat</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu">phat</span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.35</span></span></code></pre>
<p>With 100 shuffles we have an estimate of the probability of a
heart. Is our experimental result consistent with <span class="math inline">\(H_0\)</span>?</p>
<p>With a larger sample size:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="va">mydat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.243</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="an-improvised-test">An improvised test<a class="anchor" aria-label="anchor" href="#an-improvised-test"></a>
</h3>
<p>Let’s use the procedure <code>|phat(dat)-.25|&gt;.01</code> as our criterion for
rejecting
<span class="math inline">\(H_0: Pr(C_1 = \heartsuit) = 1/4\)</span>
What is the Type I error rate
for a fair deck for the experiment based on 100 shuffles?</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">NSIM</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="va">tsts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">.25</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">.01</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tsts</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.911</span></span></code></pre>
<p>Parameterize the “delta”, which was 0.01 in the previous run. Let’s
get the rejection rate estimates for two sample sizes:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prej</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span><span class="op">=</span><span class="fl">.01</span>, <span class="va">nullval</span><span class="op">=</span><span class="fl">.25</span>, <span class="va">NSIM</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="va">nullval</span><span class="op">)</span><span class="op">&gt;</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">prej</span><span class="op">(</span>delta<span class="op">=</span><span class="fl">.02</span>, NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.655</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">prej</span><span class="op">(</span>delta<span class="op">=</span><span class="fl">.02</span>, NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.323</span></span></code></pre>
<p>Our home-cooked test has a Type I error rate that is much too high
for standard practice, and depends on the sample size.</p>
</div>
<div class="section level3">
<h3 id="a-properly-calibrated-procedure">A properly calibrated procedure<a class="anchor" aria-label="anchor" href="#a-properly-calibrated-procedure"></a>
</h3>
<p>Let’s instead use the built in procedure for testing hypotheses
with binomial
outcomes.</p>
<p>The <code>brej</code> function defined below has two layers:
- inner: given N draws, test that the sum of the number of
hearts is consistent with a specified null value (1/4 by
default), with a specified Type I error rate (argument alpha)
- outer: replicate the inner process NSIM times to obtain
NSIM indicator variables taking value 1 if the test rejected
and 0 otherwise</p>
<p>We then estimate rejection probabilities by taking the means
of the indicator variables for different experimental and
replication setups.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">brej</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">deck</span>, <span class="va">nullval</span><span class="op">=</span><span class="fl">.25</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">0.05</span>, <span class="va">NSIM</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span></span>
<span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>, <span class="op">{</span></span>
<span>   <span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">deck</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="va">N</span>, <span class="va">nullval</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span></span>
<span>   <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.054</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.06</span></span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.006</span></span></code></pre>
<p>We have an indication here that the procedure stabilizes the Type I error
rate for different designs (sample sizes) and can accommodate different
significance levels.</p>
</div>
</div>
<div class="section level2">
<h2 id="power-curve">Power curve<a class="anchor" aria-label="anchor" href="#power-curve"></a>
</h2>
<p>It is often useful to sketch the power of a test procedure
over a series of values of an element of the experimental/testing
setup. We’ll consider how the power to reject the null
varies with the sample size, for two alternatives to the null.</p>
<p>We make a biased deck by switching one diamond to a heart.
For such a deck, the probability of a heart is 14/52, greater
than 1/4.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bd</span> <span class="op">=</span> <span class="va">d</span></span>
<span><span class="va">bd</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span></span>
<span><span class="co">##   ♡  1 1 1 1 2 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♢  1 1 1 1 1 0 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre>
<p>What kind of sample size do we need to get good power to detect this
exception?</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ssizes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">300</span>,<span class="fl">750</span><span class="op">)</span></span>
<span><span class="va">rejps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">bd</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps</span>, main<span class="op">=</span><span class="st">"detect one extra heart"</span><span class="op">)</span></span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/docur-1.png" width="672"></p>
<p>With two switches, the probability of a heart increases to 15/52.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bd</span><span class="op">[</span><span class="fl">19</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    </span></span>
<span><span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span></span>
<span><span class="co">##   ♡  1 1 1 1 2 2 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♢  1 1 1 1 1 0 0 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span><span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></span></code></pre>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rejps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">bd</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps</span>, main<span class="op">=</span><span class="st">"detect two extra hearts"</span><span class="op">)</span></span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/domor-1.png" width="672"></p>
<p>Finally, we show that under the null hypothesis (deck is fair)
the rejection rate is approximately 0.05 for a range of sample sizes.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rejps_n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps_n</span>, main<span class="op">=</span><span class="st">"preserve Type I error rate"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0.05</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/showpres-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<ul>
<li><p>Classical frequentist inference aims to control probabilities of
errors of Type I (reject a null hypothesis that is true) and Type II
(fail to reject a false null). The power of a test procedure is
one minus its Type II error probability.</p></li>
<li>
<p>Typically the null hypothesis specifies the value of a parameter
of a population distribution</p>
<ul>
<li>in the case of the card deck, the
hypothesis of fairness of deck and shuffling procedure entails
the probability of drawing a heart after a shuffle is 1/4</li>
<li>the experimental setup entails that the probability distribution
of the sum of the number of hearts drawn as top card under N shuffling events
is binomial(N,1/4)</li>
</ul>
</li>
<li>
<p>R’s <code>binom.test</code> is given</p>
<ul>
<li>the sum of the number of hearts observed,</li>
<li>the number of trials,</li>
<li>the parameter value defining the
null hypothesis,</li>
<li>the desired type I error rate,</li>
</ul>
</li>
</ul>
<p>and produces a
critical region using the binomial distribution</p>
<p>When the sum falls in the critical region, the null hypothesis is rejected</p>
<ul>
<li><p>Verification of achievement of the desired Type I and Type II error
probabilities for a testing procedure can be pursued via simulation</p></li>
<li><p>The power curve for a sequence of experimental conditions can be produced
via simulation</p></li>
<li><p>Analytical tools for power computation are also available. For example,
in the EnvStats package, we find</p></li>
</ul>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexkowa/EnvStats" class="external-link">EnvStats</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://alexkowa.github.io/EnvStats/reference/propTestPower.html" class="external-link">propTestPower</a></span><span class="op">(</span><span class="fl">750</span>, p.or.p1<span class="op">=</span><span class="fl">13</span><span class="op">/</span><span class="fl">52</span>, p0<span class="op">=</span><span class="fl">.25</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.05</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://alexkowa.github.io/EnvStats/reference/propTestPower.html" class="external-link">propTestPower</a></span><span class="op">(</span><span class="fl">750</span>, p.or.p1<span class="op">=</span><span class="fl">14</span><span class="op">/</span><span class="fl">52</span>, p0<span class="op">=</span><span class="fl">.25</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.2348789</span></span></code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://alexkowa.github.io/EnvStats/reference/propTestPower.html" class="external-link">propTestPower</a></span><span class="op">(</span><span class="fl">750</span>, p.or.p1<span class="op">=</span><span class="fl">15</span><span class="op">/</span><span class="fl">52</span>, p0<span class="op">=</span><span class="fl">.25</span> <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.6742566</span></span></code></pre>
<p>An exercise is to reconcile these results with the simulation-based
results given above.</p>
<p>Another is to find the sample size needed to achieve 80% power to detect
a single switch from diamond to heart in an otherwise fair deck.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
