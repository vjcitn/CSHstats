<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>S2_EDA: Exploratory data analysis and visualization • CSHstats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Courier_Prime-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="S2_EDA: Exploratory data analysis and visualization">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">CSHstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.34</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/S1_probability.html">S1_probability: Definitions and exercises</a></li>
    <li><a class="dropdown-item" href="../articles/S1b_hyper.html">S1a: A look at the hypergeometric distribution</a></li>
    <li><a class="dropdown-item" href="../articles/S2_EDA.html">S2_EDA: Exploratory data analysis and visualization</a></li>
    <li><a class="dropdown-item" href="../articles/S2a_PCAelem.html">S2a: Elements of PCA</a></li>
    <li><a class="dropdown-item" href="../articles/S3_distclust.html">S3: Distances, clustering</a></li>
    <li><a class="dropdown-item" href="../articles/S4_hypothesis_testing.html">S4_inference: Definitions and exercises</a></li>
    <li><a class="dropdown-item" href="../articles/S5_linear_models.html">S5_inference: FDR, linear models, and GLMs</a></li>
    <li><a class="dropdown-item" href="../articles/S5a_lmdiagnostics.html">S5a: Diagnostics of a differential gene expression exercise</a></li>
    <li><a class="dropdown-item" href="../articles/S5b_nonlin.html">S5b: hypothesis testing in nonlinear regression</a></li>
    <li><a class="dropdown-item" href="../articles/S6_hca_onto.html">S6 HCA, ontologies, shiny</a></li>
    <li><a class="dropdown-item" href="../articles/S7_cnn.html">S7 Neural net concepts and applications</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/vjcitn/CSHstats/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>S2_EDA: Exploratory data analysis and visualization</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">November 02, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/CSHstats/blob/HEAD/vignettes/S2_EDA.Rmd" class="external-link"><code>vignettes/S2_EDA.Rmd</code></a></small>
      <div class="d-none name"><code>S2_EDA.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="eda-exploratory-data-analysis">EDA: Exploratory data analysis<a class="anchor" aria-label="anchor" href="#eda-exploratory-data-analysis"></a>
</h2>
<p>The field of EDA has changed, thanks to advances in computational
and visualization technology. Classical EDA addressed</p>
<ul>
<li><p>Assessing distributional shape</p></li>
<li><p>Comparing batches of numbers: Boxplots and beyond</p></li>
<li><p>Transformations; handling “outliers”</p></li>
</ul>
<p>More recently, we can consider exploratory data activities that use</p>
<ul>
<li><p>interactive tables</p></li>
<li><p>interactive graphics</p></li>
<li><p>purpose-built graphical user interfaces</p></li>
</ul>
<p>We will explore all of these concerns. Our principles include</p>
<ul>
<li>always be prepared to “look at the data”
<ul>
<li>when very high volumes are involved, sampling and dimension reduction
are relevant</li>
</ul>
</li>
<li>every facet of your data should be accessible to exploration and summarization</li>
</ul>
</div>
<div class="section level2">
<h2 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ul>
<li>Know and propagate knowledge of Anscombe’s quartet
<ul>
<li>simple statistics may fail to disclose structure</li>
<li>visualization should always be conducted</li>
</ul>
</li>
<li>Many exploratory tools are tunable and the tuning affects interpretation
<ul>
<li>understand how you might use shiny to explore tunable data visualization</li>
</ul>
</li>
<li>Data transformations can be useful for allowing the use of classical methods
<ul>
<li>The Box-Cox transformation family provides clues for choosing a transformation</li>
</ul>
</li>
<li>QQplots help us reason about the suitability of reference distributions
<ul>
<li>We only look at qqnorm, but qqplot allows more general comparisons</li>
</ul>
</li>
<li>Shiny + TnT allow exploration of data in the context of linear genome annotation</li>
</ul>
</div>
<div class="section level2">
<h2 id="anscombes-quartet-statistics-that-miss-the-point">Anscombe’s quartet: statistics that miss the point<a class="anchor" aria-label="anchor" href="#anscombes-quartet-statistics-that-miss-the-point"></a>
</h2>
<p>In 1973 Francis Anscombe constructed four bivariate
datasets. The four datasets
of interest are the pairs of columns (x1, y1), (x2, y2), ….</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/DT" class="external-link">DT</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">anscombe</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/DT/man/datatable.html" class="external-link">datatable</a></span><span class="op">(</span><span class="va">anscombe</span><span class="op">)</span></span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11"],[10,8,13,9,11,14,6,4,12,7,5],[10,8,13,9,11,14,6,4,12,7,5],[10,8,13,9,11,14,6,4,12,7,5],[8,8,8,8,8,8,8,19,8,8,8],[8.039999999999999,6.95,7.58,8.81,8.33,9.960000000000001,7.24,4.26,10.84,4.82,5.68],[9.140000000000001,8.140000000000001,8.74,8.77,9.26,8.1,6.13,3.1,9.130000000000001,7.26,4.74],[7.46,6.77,12.74,7.11,7.81,8.84,6.08,5.39,8.15,6.42,5.73],[6.58,5.76,7.71,8.84,8.470000000000001,7.04,5.25,12.5,5.56,7.91,6.89]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>x1<\/th>\n      <th>x2<\/th>\n      <th>x3<\/th>\n      <th>x4<\/th>\n      <th>y1<\/th>\n      <th>y2<\/th>\n      <th>y3<\/th>\n      <th>y4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"x1","targets":1},{"name":"x2","targets":2},{"name":"x3","targets":3},{"name":"x4","targets":4},{"name":"y1","targets":5},{"name":"y2","targets":6},{"name":"y3","targets":7},{"name":"y4","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script><p>In our discussion of probability we provided definitions of
mean, variance, covariance, correlation. Here is a quick check
on the means of the variables in the quartet.</p>
<ul>
<li>We use the <code>apply</code> function which has general arguments</li>
</ul>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">MARGIN</span>, <span class="va">FUN</span>, <span class="va">...</span>, simplify<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre>
<p>where <code>X</code> is some array-like entity, <code>MARGIN</code> defines
the dimension along with <code>FUN</code> will be computed
with additional arguments possibly provided in <code>...</code>.</p>
<ul>
<li><p>When <code>MARGIN</code> is 1, <code>FUN</code> is computed on each “row”,
when <code>MARGIN</code> is 2, <code>FUN</code> is computed on each “column”.</p></li>
<li><p>We also introduce a helper function <code>rounded_stat</code> which
rounds the result of a univariate statistic.</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rounded_stat</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">stat</span><span class="op">=</span><span class="va">mean</span>, <span class="va">ndig</span><span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">stat</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">ndig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">anscombe</span>, <span class="fl">2</span>, <span class="va">rounded_stat</span>, stat<span class="op">=</span><span class="va">mean</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  x1  x2  x3  x4  y1  y2  y3  y4 </span></span>
<span><span class="co">## 9.0 9.0 9.0 9.0 7.5 7.5 7.5 7.5</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">anscombe</span>, <span class="fl">2</span>, <span class="va">rounded_stat</span>, stat<span class="op">=</span><span class="va">sd</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   x1   x2   x3   x4   y1   y2   y3   y4 </span></span>
<span><span class="co">## 3.32 3.32 3.32 3.32 2.03 2.03 2.03 2.03</span></span></code></pre>
<p>This code demonstrates that the x and y variables have identical means
and standard deviations.</p>
<p>Nevertheless, when the variables are plotted against one another, we have:</p>
<p><img src="S2_EDA_files/figure-html/lkda-1.png" width="672"></p>
<div class="section level4">
<h4 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h4>
<p><strong>1. Show that the four correlation coefficients for (x1, y1), …, (x4, y4)
are identical (up to rounding).</strong></p>
<p><strong>2. This <a href="https://www.njtierney.com/post/2020/06/01/tidy-anscombe/" class="external-link">blog post</a>
addresses the tidyverse approach to handling the data.
Read the blog post and try to get comfortable with the various steps
towards producing and using a “tidy” representation.</strong></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># use BiocManager::install("tidyverse") if necessary</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="va">tidy_anscombe</span> <span class="op">&lt;-</span> <span class="va">anscombe</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>              names_to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">".value"</span>, <span class="st">"set"</span><span class="op">)</span>,</span>
<span>              names_pattern <span class="op">=</span> <span class="st">"(.)(.)"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tidy_anscombe</span>,</span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,</span>
<span>           y <span class="op">=</span> <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">set</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `geom_smooth()` using formula = 'y ~ x'</span></span></code></pre>
<p><img src="S2_EDA_files/figure-html/doansc-1.png" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="exploring-distributional-shape">Exploring distributional shape<a class="anchor" aria-label="anchor" href="#exploring-distributional-shape"></a>
</h2>
<div class="section level3">
<h3 id="univariate">Univariate<a class="anchor" aria-label="anchor" href="#univariate"></a>
</h3>
<p>The mode of a distribution is the “most common value”. The peak
of a histogram would correspond to the mode of the corresponding
distribution for a discrete random variable. For continuous
random variables, the mode is given by the peak of the density function.</p>
<p>A basic question about a univariate dataset is: Could it have
a multimodal distribution?</p>
<p><strong>Live Exercise: programming interactive exploration.</strong></p>
<p><strong>Use R studio’s File control to produce
a new “Shiny app”, and give it the name “modality”. Then use “Run app”
control.</strong></p>
<p><strong>The slider controls the number of bins used to summarize the values
of times of geyser eruption. How many modes might the underlying
distribution have?</strong></p>
</div>
<div class="section level3">
<h3 id="transformation">Transformation<a class="anchor" aria-label="anchor" href="#transformation"></a>
</h3>
<p>To search for a transformation that best symmetrizes a skewed distribution,
the <code>boxcox</code> function from the MASS library can be used.
The origins of the procedure were reported to the Royal Statistical
Society in 1964.</p>
<div class="figure">
<img src="boxcoxJRSS.jpg" alt=""><p class="caption">JRSS paper</p>
</div>
<p>The basic idea is that we can construct a series of functional
transformations of a random variable to produce a distribution
(on the transformed scale) that is approximately normal. The
Box-Cox family of transformations is indexed by a single parameter,
<span class="math inline">\(\lambda\)</span>. The transformation of the variable <span class="math inline">\(y\)</span> to
<span class="math inline">\(y^*(\lambda) = \lambda^{-1}(y^\lambda-1)\)</span> (if <span class="math inline">\(\lambda \neq 0\)</span>) and
log <span class="math inline">\(y\)</span> if <span class="math inline">\(\lambda = 0\)</span> provides a smooth
traversal of (fractional) power, logarithm, and reciprocal power
operations on <span class="math inline">\(y\)</span>. If <span class="math inline">\(\lambda\)</span> is 1, no transformation is indicated.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">fos_ex</span>, main<span class="op">=</span><span class="st">"raw"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"sqrt"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">^</span><span class="fl">2</span>, main<span class="op">=</span><span class="st">"square"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"log"</span><span class="op">)</span></span></code></pre></div>
<p><img src="S2_EDA_files/figure-html/doboxc-1.png" width="672"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
<p>The boxcox function in the MASS library will trace the likelihood
function that is maximized when the distribution of <span class="math inline">\(y^*(\lambda)\)</span> is
as close to Gaussian as possible.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://www.stats.ox.ac.uk/pub/MASS4/" class="external-link">MASS</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/boxcox.html" class="external-link">boxcox</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span> <span class="co"># must use formula</span></span></code></pre></div>
<p><img src="S2_EDA_files/figure-html/doboco-1.png" width="672"></p>
<div class="section level4">
<h4 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h4>
<p><strong>3. What transformation does boxcox() recommend when applied to <code>log(egr1_ex)</code>?</strong></p>
<p><strong>4. What transformation does boxcox() recommend when applied to the geyser data
that we started out with?</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="is-it-gaussian">Is it Gaussian?<a class="anchor" aria-label="anchor" href="#is-it-gaussian"></a>
</h3>
<p>The concept of the Q-Q plot (quantile-quantile plot) is used to
compare a given data vector to a reference distribution (or to
the distribution of some other data vector).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></span><span class="op">(</span><span class="va">fos_ex</span>, main<span class="op">=</span><span class="st">"Compare FOS to Gaussian distribution"</span><span class="op">)</span></span></code></pre></div>
<p><img src="S2_EDA_files/figure-html/lkqqp-1.png" width="672"></p>
<p>If the configuration of points in the Q-Q plot does not
form a straight line, the reference distribution is probably
not appropriate.</p>
<div class="section level4">
<h4 id="exercises-1">Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"></a>
</h4>
<p><strong>5. Use qqnorm with the log(fos_ex) and comment.</strong></p>
<p><strong>6. <code>zsc = function(x) (x - mean(x))/sd(x)</code>. What is special
about <code>qqnorm(zsc(log(fos_ex)))</code>?</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="bivariate">Bivariate<a class="anchor" aria-label="anchor" href="#bivariate"></a>
</h3>
<p>We can use density estimation in the plane to reason about
multimodality in bivariate data. This is from <code>example(geom_density_2d)</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">datasets</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">)</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">faithful</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">eruptions</span>, y <span class="op">=</span> <span class="va">waiting</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">xlim</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">6</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">110</span><span class="op">)</span></span>
<span><span class="co"># contour lines</span></span>
<span><span class="va">m</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density_2d</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="S2_EDA_files/figure-html/dobiv-1.png" width="672"></p>
<div class="section level4">
<h4 id="exercise-1">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h4>
<p><strong>7. Comment on the meaning of “local modes” in these “marginal” displays.</strong></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opar</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>no.readonly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">erup</span>, <span class="fl">.08</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">faithful</span><span class="op">$</span><span class="va">wait</span>, <span class="fl">1.4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="S2_EDA_files/figure-html/lksmoo-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="exercise-2">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h4>
<p><strong>8. (advanced): Produce a shiny app that has a controller for the
bandwidth of the density estimator for viewing the
bivariate structure of the <code>faithful</code> data.</strong>
```</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-data-in-the-context-of-the-genome">Visualizing data in the context of the genome<a class="anchor" aria-label="anchor" href="#visualizing-data-in-the-context-of-the-genome"></a>
</h2>
<p>We will use <code>https://vjcitn.shinyapps.io/tnt4dn8</code> to look at
GWAS and eQTL data jointly.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
