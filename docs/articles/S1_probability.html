<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CSHstats">
<title>S1_probability: Definitions and exercises • CSHstats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Roboto-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Courier%20Prime-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="S1_probability: Definitions and exercises">
<meta property="og:description" content="CSHstats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CSHstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.9</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/S1_probability.html">S1_probability: Definitions and exercises</a>
    <a class="dropdown-item" href="../articles/S2_EDA.html">S2_EDA: Exploratory data analysis and visualization</a>
    <a class="dropdown-item" href="../articles/S3_hypothesis_testing.html">S3_inference: Definitions and exercises</a>
    <a class="dropdown-item" href="../articles/S4_linear_models.html">S4_inference: Linear models and GLMs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vjcitn/CSHstats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>S1_probability: Definitions and exercises</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">July 01, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/CSHstats/blob/HEAD/vignettes/S1_probability.Rmd" class="external-link"><code>vignettes/S1_probability.Rmd</code></a></small>
      <div class="d-none name"><code>S1_probability.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<ul>
<li>Gain familiarity with concepts of simulation in R using sampling from
specified sets (e.g., a deck of cards) and using random number generation
<ul>
<li>understand the use of <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code>
</li>
<li>understand how to use <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> to control the behavior of random number generation</li>
</ul>
</li>
<li>Estimate event probabilities for specified experimental setups
<ul>
<li>distinguish the sample size of an experiment and the replication size of a simulation</li>
</ul>
</li>
<li>Explain the relationship between precision of a probability estimate and the sample
size of the associated experiment</li>
<li>Define and use probability mass functions for discrete outcomes
<ul>
<li>for binomially distributed outcomes</li>
<li>for outcomes governed by the Poisson and Negative Binomial models</li>
<li>in general</li>
</ul>
</li>
<li>Understand how to simulate data under null (e.g., fair deck) and alternative (e.g.,
biased deck) conditions</li>
<li>Understand the difference between finite, countably infinite, and uncountably
infinite sample spaces</li>
<li>Define and use probability density functions and cumulative distribution functions
for continuous outcomes</li>
</ul>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Our concept of probability is that of “long run relative frequency”.</p>
<p>We’ll work with several models of random events to make this more concrete.</p>
</div>
<div class="section level2">
<h2 id="the-probability-of-a-0-1-binary-or-dichotomous-event">The probability of a 0-1 (binary or dichotomous) event<a class="anchor" aria-label="anchor" href="#the-probability-of-a-0-1-binary-or-dichotomous-event"></a>
</h2>
<div class="section level3">
<h3 id="simulating-shuffled-playing-cards">Simulating shuffled playing cards<a class="anchor" aria-label="anchor" href="#simulating-shuffled-playing-cards"></a>
</h3>
<div class="section level4">
<h4 id="random-permutations-with-sample">Random permutations with <code>sample()</code><a class="anchor" aria-label="anchor" href="#random-permutations-with-sample"></a>
</h4>
<p>We’ll take for granted that <code>sample(x, size=length(x), replace=FALSE)</code> in R
achieves a goal of “shuffling” elements of <code>x</code>. Thus we assume that,
if <code>x</code> is a vector in R, and</p>
<pre><code><span class="va">s1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre>
<p>then no aspect of the ordering of elements in
<code>s1</code> can be used to predict anything about the ordering of elements of <code>s2</code>.</p>
<p>In other words, <code>sample(x, size, replace=FALSE)</code> is taken as a primitive operation
that permutes the elements of <code>x</code> in a “random” way.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5432</span><span class="op">)</span> <span class="co"># initialize, for reproducibility, the random number generator</span>
<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># permute (1,2,3,4,5)</span></code></pre></div>
<pre><code><span class="co">## [1] 4 2 1 3 5</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># a new, unpredictable, permutation</span></code></pre></div>
<pre><code><span class="co">## [1] 3 4 1 2 5</span></code></pre>
<div class="section level5">
<h5 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h5>
<p><strong>1: Why is the second permutation produced above termed “unpredictable”?</strong></p>
<p><strong>2: Predict the outcome of <code>sample(1:5, replace=FALSE)</code>, run just
after the one shown above.</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="card-deck-definitions-and-operations">Card deck definitions and operations<a class="anchor" aria-label="anchor" href="#card-deck-definitions-and-operations"></a>
</h4>
<p>Our card deck is a vector with 52 elements. Unicode characters encode the “suits”.</p>
<p>If you have not already installed CSHstats (or did so a long time ago) use</p>
<pre><code><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"vjcitn/CSHstats"</span><span class="op">)</span>  <span class="co"># install.packages("BiocManager") if necessary</span></code></pre>
<p>to get access to the software needed to do the computations in this document.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/CSHstats" class="external-link">CSHstats</a></span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_deck.html">build_deck</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">d</span></code></pre></div>
<pre><code><span class="co">##  [1] "2 ♡"  "3 ♡"  "4 ♡"  "5 ♡"  "6 ♡"  "7 ♡"  "8 ♡"  "9 ♡"  "10 ♡" "J ♡" </span>
<span class="co">## [11] "Q ♡"  "K ♡"  "A ♡"  "2 ♢"  "3 ♢"  "4 ♢"  "5 ♢"  "6 ♢"  "7 ♢"  "8 ♢" </span>
<span class="co">## [21] "9 ♢"  "10 ♢" "J ♢"  "Q ♢"  "K ♢"  "A ♢"  "2 ♣"  "3 ♣"  "4 ♣"  "5 ♣" </span>
<span class="co">## [31] "6 ♣"  "7 ♣"  "8 ♣"  "9 ♣"  "10 ♣" "J ♣"  "Q ♣"  "K ♣"  "A ♣"  "2 ♤" </span>
<span class="co">## [41] "3 ♤"  "4 ♤"  "5 ♤"  "6 ♤"  "7 ♤"  "8 ♤"  "9 ♤"  "10 ♤" "J ♤"  "Q ♤" </span>
<span class="co">## [51] "K ♤"  "A ♤"</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "♡" "♢" "♣" "♤"</span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "J"  "Q"  "K"  "A"</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<p>A fair deck has one card for each combination of “face” and “suit”.</p>
<div class="section level5">
<h5 id="exercises-1">Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"></a>
</h5>
<p><strong>3: Write the code that produces a new deck that is
fair except that it has two copies
of the ten of hearts. Verify that your new deck has this property.</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="shuffling-the-deck">Shuffling the deck<a class="anchor" aria-label="anchor" href="#shuffling-the-deck"></a>
</h4>
<p>A reproducible shuffling event can be programmed as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>  <span class="co"># any numeric seed will do but you need to record it</span>
<span class="va">shuffle_deck</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">d</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>         <span class="co"># top 6 cards</span></code></pre></div>
<pre><code><span class="co">## [1] "2 ♡" "3 ♡" "4 ♡" "5 ♡" "6 ♡" "7 ♡"</span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "3 ♣"  "4 ♢"  "10 ♢" "Q ♣"  "6 ♤"  "9 ♤"</span></code></pre>
</div>
<div class="section level4">
<h4 id="the-top-card-after-a-shuffle">The top card after a shuffle<a class="anchor" aria-label="anchor" href="#the-top-card-after-a-shuffle"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4141</span><span class="op">)</span>
<span class="va">top_draw</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "A ♤"</span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "5 ♤"</span></code></pre>
<div class="section level5">
<h5 id="exercises-2">Exercises<a class="anchor" aria-label="anchor" href="#exercises-2"></a>
</h5>
<p><strong>4: What is the top card in the next shuffle?</strong></p>
<p><strong>5: Write code to get the third card.</strong></p>
<p><strong>6: What is the probability that the top draw of a shuffled fair deck is a heart?</strong></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-probability-of-an-event">Estimating the probability of an event<a class="anchor" aria-label="anchor" href="#estimating-the-probability-of-an-event"></a>
</h3>
<div class="section level4">
<h4 id="a-simulation-process-repeated-shuffles-and-draws">A simulation process: repeated shuffles and draws<a class="anchor" aria-label="anchor" href="#a-simulation-process-repeated-shuffles-and-draws"></a>
</h4>
<p>Here’s a simple way of estimating the probability
that the top draw of a shuffled fair deck is a heart, construed as long run frequency.</p>
<p>We’ll simulate 100 shuffles and save the results of testing the suit of the top card.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heart_sign</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="st">"\U2661"</span>  <span class="co"># unicode U2661, prepend backslash</span>
<span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "♡"</span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">100</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">res</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># TRUE if top card is a heart</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] FALSE FALSE  TRUE  TRUE  TRUE FALSE</span></code></pre>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### relative frequency of the event "suit of top card is 'heart'"</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>  </code></pre></div>
<pre><code><span class="co">## [1] 0.36</span></code></pre>
<p>A more concise approach with R is:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="fl">100</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.22</span></code></pre>
<div class="section level5">
<h5 id="exercises-3">Exercises<a class="anchor" aria-label="anchor" href="#exercises-3"></a>
</h5>
<p><strong>7: How do we interpret the difference between the two probability estimates given here?</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="replicating-the-estimation-process">Replicating the estimation process<a class="anchor" aria-label="anchor" href="#replicating-the-estimation-process"></a>
</h4>
<p>Let’s intensify our investigation with an aim
of understanding the uncertainty of estimation.</p>
<p>We’ll define a variable that gives the size of our “experiment”: we are shuffling
100 times and we’ll refer to this as the sample size, <code>SSIZE</code></p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">100</span></code></pre></div>
<p>We will study the estimation procedure by replicating the experiment <code>N_REPLICATION</code> times.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_REPLICATION</span> <span class="op">=</span> <span class="fl">500</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10101</span><span class="op">)</span> <span class="co"># initialize, for reproducibility, the random number generator</span>
<span class="va">doubsim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N_REPLICATION</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="va">SSIZE</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkhist1-1.png" width="672"></p>
<div class="section level5">
<h5 id="exercises-4">Exercises<a class="anchor" aria-label="anchor" href="#exercises-4"></a>
</h5>
<p><strong>8: How can we make the estimate of the probability of the event “suit of top card is ‘heart’” more precise?</strong></p>
<p>Answer: increase <code>SSIZE</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">500</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101012</span><span class="op">)</span>
<span class="va">doubsim2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N_REPLICATION</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="va">SSIZE</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim2</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkhj-1.png" width="672"></p>
<p>With an increased “sample size”,
we have reduced variation in our experiment-to-experiment estimates of the probability
of heart as suit of top card.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="formal-probability-models">Formal probability models<a class="anchor" aria-label="anchor" href="#formal-probability-models"></a>
</h3>
<p>Intuitively, the probability of drawing a heart from a well-shuffled
fair deck is 1/4. If we repeat the shuffling and drawing one hundred times,
we expect <strong>around</strong> 25 draws to reveal a heart.</p>
<p>Formal probability models enable us to reason systematically about
what we mean by <strong>around</strong> in our description of our expectation.
With these models we can also create accurate predictions of likely outcomes in
more complex events.</p>
<p>It is useful to define the <strong>sample space</strong> for a probability model,
which is the set of all possible outcomes of the random process being
modeled. For our top-card-drawn example, the sample space
is the set of suits, because we disregard the
face value. For the fair deck, each point
in the sample space has probability <span class="math inline">\(1/4\)</span>.
Events of interest are “top card is a heart”
and “top card is not a heart”. The probabilities of
these events are derivable from the probabilities of
the constituent outcomes.</p>
<div class="section level4">
<h4 id="using-the-binomial-probability-model">Using the binomial probability model<a class="anchor" aria-label="anchor" href="#using-the-binomial-probability-model"></a>
</h4>
<p>A series of independent dichotomous events (true or false, zero or one, heart or non-heart)
can be modeled using a <strong>probability mass function</strong> for the binomial distribution. There are two parameters,
<span class="math inline">\(p\)</span> and <span class="math inline">\(n\)</span>, where <span class="math inline">\(p\)</span> is the (unobservable) probability of the event (say “suit of top card is ‘heart’”)
and <span class="math inline">\(n\)</span> is the number of <strong>independent</strong> trials in which the random dichotomy is observed. In <span class="math inline">\(n\)</span> “trials”,
if the event has probability <span class="math inline">\(p\)</span>, the probability of seeing the event <span class="math inline">\(x\)</span> times is
<span class="math display">\[
Pr(X = x; n, p) = {\binom{n}{x}} p^x(1-p)^{n-x}
\]</span>
where have written <span class="math inline">\(X\)</span> to denote the random quantity and <span class="math inline">\(x\)</span> to denote its realization.</p>
<p>So for a single draw, with <span class="math inline">\(X\)</span> the count of hearts seen in the draw, we have
<span class="math display">\[
Pr(X=0; 1, 1/4) = 1-1/4 = 3/4
\]</span>
<span class="math display">\[
Pr(X=1; 1, 1/4) = 1/4
\]</span></p>
<div class="section level5">
<h5 id="exercises-5">Exercises<a class="anchor" aria-label="anchor" href="#exercises-5"></a>
</h5>
<p><strong>9: Modify the production of <code>doubsim2</code> so that the <span class="math inline">\(x\)</span>-axis for the
histogram has units “number of times the top card is a heart”.</strong></p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim3</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span><span class="op">*</span><span class="fl">500</span>,<span class="fl">.35</span><span class="op">*</span><span class="fl">500</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"count of draws with heart as suit of top card"</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/dodou3h-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="visualizing-the-model-and-the-data">Visualizing the model and the data<a class="anchor" aria-label="anchor" href="#visualizing-the-model-and-the-data"></a>
</h4>
<p>The formula given above tells us how frequently we will observe a given count. The
R function <code>dbinom</code> can compute the probability, which we multiply by the number
of realizations to get the height of the histogram.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim3</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span><span class="op">*</span><span class="fl">500</span>,<span class="fl">.35</span><span class="op">*</span><span class="fl">500</span><span class="op">)</span>, 
   xlab<span class="op">=</span><span class="st">"count of draws with heart as suit of top card"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">115</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">160</span>, <span class="fl">2500</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">160</span>, <span class="fl">500</span>, <span class="fl">13</span><span class="op">/</span><span class="fl">52</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">110</span>, pch<span class="op">=</span><span class="fl">19</span>, legend<span class="op">=</span><span class="st">"scaled dbinom(x, 500, .25)"</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex<span class="op">=</span><span class="fl">.85</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/sketch-1.png" width="672"></p>
<p>Notice that the histogram, by virtue of its binning of the counts, does
not seem to reflect the shape of the theoretical frequency function given by the dots.
This can be remedied by increasing the number of replicates used.</p>
<p>There is considerable research regarding the design of histogram displays.
See <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">?nclass.Sturges</a></code> for references. One unpleasant feature of the
display for doubsim2 is that it seems to imply an asymmetric distribution.
Another is the way it “cuts off” at the extremes.</p>
<div class="section level5">
<h5 id="exercises-6">Exercises<a class="anchor" aria-label="anchor" href="#exercises-6"></a>
</h5>
<p><strong>10: Write a couple of sentences carefully distinguishing the
displays of doubsim2 and doubsim3 above. Explain the choice of
the heuristic name “doubsim”.</strong></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="a-biased-deck">A biased deck<a class="anchor" aria-label="anchor" href="#a-biased-deck"></a>
</h3>
<p>Recall the layout of the fair deck:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<p>We will make a copy of one card and remove one:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bd</span> <span class="op">=</span> <span class="va">d</span>
<span class="va">bd</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 2 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 0 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<div class="section level4">
<h4 id="exercises-7">Exercises<a class="anchor" aria-label="anchor" href="#exercises-7"></a>
</h4>
<p><strong>11: What is the probability that the top card drawn after
a shuffle of <code>bd</code> is a heart?</strong></p>
<p><strong>12: What is the probability that the top card drawn after
a shuffle of <code>bd</code> is a club?</strong></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="probability-models-for-categorical-outcomes">Probability models for categorical outcomes<a class="anchor" aria-label="anchor" href="#probability-models-for-categorical-outcomes"></a>
</h2>
<p>Thus far we have focused on the dichotomy: top draw is heart or not.
We can consider all the possible suits as a 4-valued response.</p>
<div class="section level3">
<h3 id="a-contingency-table">A contingency table<a class="anchor" aria-label="anchor" href="#a-contingency-table"></a>
</h3>
<p>Let’s simulate the process of drawing the top card after
shuffling, and tabulate the suits observed.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4321</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">tops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##   ♡   ♢   ♣   ♤ </span>
<span class="co">## 148 106 126 120</span></code></pre>
<div class="section level4">
<h4 id="exercises-8">Exercises<a class="anchor" aria-label="anchor" href="#exercises-8"></a>
</h4>
<p><strong>13: What would you expect for the counts for suits in the table above
if the deck were fair?</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="multinomial-model-and-simulation">Multinomial model and simulation<a class="anchor" aria-label="anchor" href="#multinomial-model-and-simulation"></a>
</h3>
<p>We adopted the binomial model for the number of top draws
with suit “heart” in a fixed number of shuffles:</p>
<p><span class="math display">\[
Pr(X = x; n, p) = {\binom{n}{x}} p^x(1-p)^{n-x}
\]</span></p>
<p>With the fair deck, we have <span class="math inline">\(p= 1/4\)</span>. A generalization
to a vector of responses is the multinomial model. We
can use this for the (ordered) vector of counts of
top draws yielding different suits. For this problem
we have parameters <span class="math inline">\(N\)</span> (number of trials), <span class="math inline">\(k\)</span> (number
of categories), and <span class="math inline">\(p_1, \ldots, p_k\)</span>, the category-specific
probabilities. The realizations are denoted <span class="math inline">\(x_1, \ldots, x_k\)</span>
and we have <span class="math inline">\(\sum_i x_i = N\)</span>.</p>
<p>Now the probability model is defined in terms of random
vectors and vectors of probabilities:</p>
<p><span class="math display">\[
Pr(X_1 = x_1, \ldots, X_k = x_k) = \frac{n!}{x_1! \cdots x_k!} p_1^{x_1} \cdots p_k^{x_k}
\]</span></p>
<p>This provides a more elegant way of producing frequency distributions
of the suit of the top draw. Here we introduce pseudorandom number
generation from the multinomial model, using <code>rmultinom</code>.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NREP</span> <span class="op">=</span> <span class="fl">10000</span>
<span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">500</span>
<span class="va">mnmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="va">NREP</span>, <span class="va">SSIZE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mnmat</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\U2661"</span>, <span class="st">"\U2662"</span>, <span class="st">"\U2663"</span>, <span class="st">"\U2664"</span><span class="op">)</span>
<span class="va">mnmat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>  <span class="co"># one draw</span></code></pre></div>
<pre><code><span class="co">##   ♡   ♢   ♣   ♤ </span>
<span class="co">## 131 125 110 134</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mnmat</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##        ♡        ♢        ♣        ♤ </span>
<span class="co">## 124.9621 124.9080 125.0362 125.0937</span></code></pre>
<p>Notice that we did not use the deck <code>d</code> in producing this matrix
of counts. Previously we applied <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> to the 52-vector of
cards. Now we use the model to develop the data
of interest.</p>
<div class="section level4">
<h4 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h4>
<p><strong>14: Modify the call to <code>rmultinom</code> to obtain distributions of
top card suits for the biased deck <code>bd</code>.<br>
Hint: Change the part of the call involving <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code>.</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="the-poisson-distribution">The Poisson distribution<a class="anchor" aria-label="anchor" href="#the-poisson-distribution"></a>
</h3>
<div class="section level4">
<h4 id="modeling-collections-of-counts">Modeling collections of counts<a class="anchor" aria-label="anchor" href="#modeling-collections-of-counts"></a>
</h4>
<p>Outcomes taking the form of integer counts arise in many
appications. As an example, a quarry floor is divided into
squares about one meter on the side. 30 squares were searched
for a fossil and the number of specimens per square is recorded.
No square had 5 or more specimens. (Example from <em>Probability
Models and Applications</em>, I. Olkin, L. Gleser, C. Derman, ch 6.3.)</p>
<p>The table below includes <code>nspec</code>, the number of specimens in
a square, <code>freq</code>, the number of squares having the corresponding
number of specimens, and <code>pred</code>, a predicted number of specimens
based on the Poisson model with mean parameter 0.73 specimens
per square.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">foss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>nspec<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, freq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>,<span class="fl">9</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, pred<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fl">30</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">dpois</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">0.73</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">foss</span></code></pre></div>
<pre><code><span class="co">##   nspec freq  pred</span>
<span class="co">## 1     0   16 14.46</span>
<span class="co">## 2     1    9 10.55</span>
<span class="co">## 3     2    3  3.85</span>
<span class="co">## 4     3    1  0.94</span>
<span class="co">## 5     4    1  0.17</span></code></pre>
<p>To derive the quantities <code>pred</code>, we used <code>dpois</code> for the counts per square,
with mean parameter set at 0.73. To derive this, we use</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">foss</span><span class="op">$</span><span class="va">nspec</span> <span class="op">*</span> <span class="va">foss</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span><span class="op">/</span><span class="fl">30</span></code></pre></div>
<pre><code><span class="co">## [1] 0.7333333</span></code></pre>
<p>to obtain the average number of fossils per square. The Poisson model with
mean <span class="math inline">\(\lambda\)</span> is
<span class="math display">\[
Pr(X = x; \lambda) = \frac{e^{-\lambda}\lambda^k}{k!}
\]</span></p>
</div>
<div class="section level4">
<h4 id="exercise-1">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h4>
<p><strong>15: Use the formula above to explain the prediction of 14.46 squares with zero fossils.</strong></p>
</div>
<div class="section level4">
<h4 id="a-countably-infinite-sample-space">A countably infinite sample space<a class="anchor" aria-label="anchor" href="#a-countably-infinite-sample-space"></a>
</h4>
<p>The binomial and multinomial models discussed above have finite
discrete sample spaces. The sample space for the Poisson model
is the set of non-negative integers. The mass function arises
from the fact that <span class="math inline">\(e^\lambda = \sum \lambda^k/k!\)</span>, the sum
taken over all non-negative integers.</p>
</div>
</div>
<div class="section level3">
<h3 id="the-negative-binomial-model">The negative binomial model<a class="anchor" aria-label="anchor" href="#the-negative-binomial-model"></a>
</h3>
<p>The mass function is
<span class="math display">\[
p(x; \theta, \mu) = \frac{\Gamma(\theta + x)}{\Gamma(\theta)y!} 
   \frac{\mu^y \theta^\theta}{(\mu + \theta)^{\theta + y}}
\]</span></p>
<p>This will be useful for later material.</p>
</div>
<div class="section level3">
<h3 id="mean-variance">Mean, variance<a class="anchor" aria-label="anchor" href="#mean-variance"></a>
</h3>
<p>The sample mean for the vector <span class="math inline">\(x = (x_1, \ldots, x_n)\)</span>
is defined as <span class="math inline">\(\bar{x} = n^{-1}\sum_i x_i\)</span>. The (unbiased estimator
of the) sample variance
is <span class="math inline">\((n-1)^{-1}\sum_i (x_i = \bar{x})^2\)</span>.</p>
<p>We will sometimes refer to mean and
variance in the context of probability models
rather than samples. The mean for a continuous
distribution is defined as</p>
<p>For a discrete distribution with probability
mass function <span class="math inline">\(p\)</span> the mean is</p>
<p><span class="math display">\[
E(x) = \sum x p(x),
\]</span>
The sum here is taken over the sample space
for the associated model.</p>
<p>Writing <span class="math inline">\(\mu\)</span> for the mean value of the distribution
under study, the variance of a discrete distribution
is
<span class="math display">\[
V(x) = \sum (x-\mu)^2 p(x) dx.
\]</span></p>
</div>
</div>
<div class="section level2">
<h2 id="models-for-continuous-outcomes">Models for continuous outcomes<a class="anchor" aria-label="anchor" href="#models-for-continuous-outcomes"></a>
</h2>
<p>The models we’ve considered thus far are for discrete
responses – the sample space is either finite or countably infinite.</p>
<p>For continuous responses, the sample space is uncountably
infinite. The sample space may be an interval of the real line,
or the whole real line. We will discuss how to
define probabilities for subsets of the sample space.</p>
<div class="section level3">
<h3 id="univariate-response">Univariate response<a class="anchor" aria-label="anchor" href="#univariate-response"></a>
</h3>
<p>For concreteness, we will use RNA-seq data derived
from The Cancer Genome Atlas. We’ll focus on 79
values of normalized RSEM-based estimates of
expression of YY1 in adrenocortical carcinoma.</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">yy1_ex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">yy1_ex</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## TCGA-OR-A5J1-01A-11R-A29S-07 TCGA-OR-A5J2-01A-11R-A29S-07 </span>
<span class="co">##                    1455.8117                    1688.6318 </span>
<span class="co">## TCGA-OR-A5J3-01A-11R-A29S-07 TCGA-OR-A5J5-01A-11R-A29S-07 </span>
<span class="co">##                    1821.3598                    1877.6143 </span>
<span class="co">## TCGA-OR-A5J6-01A-31R-A29S-07 TCGA-OR-A5J7-01A-11R-A29S-07 </span>
<span class="co">##                     634.3023                    1132.3706</span></code></pre>
<p>We will refer to this as a vector of “real valued” outcomes.</p>
<div class="section level4">
<h4 id="cumulative-distribution-function-quantiles">Cumulative distribution function; quantiles<a class="anchor" aria-label="anchor" href="#cumulative-distribution-function-quantiles"></a>
</h4>
<p>We’ll use capital letters to denote random variables.
The formal definition of “random variable” is given
in textbooks; we will use the term informally to
refer to quantities we regard as random.</p>
<p>The function <span class="math inline">\(F(x) = \mbox{Pr}(X &lt; x)\)</span> is called
the cumulative distribution function (CDF) for
the random variable <span class="math inline">\(X\)</span>. For the
YY1 measures, we can produce a visualization of
the associated CDF:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ecdf.html" class="external-link">ecdf</a></span><span class="op">(</span><span class="va">yy1_ex</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">.8</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="fl">1583</span>, <span class="fl">.8</span>, <span class="fl">1583</span>, <span class="fl">0</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkecdf-1.png" width="672"></p>
<p>The quantiles of a distribution are given by
the inverse of the CDF. The quantile function
takes a number <span class="math inline">\(p\)</span> between 0 and 1 and returns
the number <span class="math inline">\(F^{-1}(p)\)</span>.</p>
<p>The graph above shows that the 0.80 quantile
of the distribution of our YY1 vector is about 1584.</p>
</div>
<div class="section level4">
<h4 id="exercise-2">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h4>
<p><strong>16: Show that the proportion of YY1 observations
exceeding 1584 is approximately 20%.</strong></p>
</div>
<div class="section level4">
<h4 id="histogram-probability-density-function">Histogram, probability density function<a class="anchor" aria-label="anchor" href="#histogram-probability-density-function"></a>
</h4>
<p>The histogram is a tunable display of the relative
frequencies of values in a vector.</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">yy1_ex</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">2600</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">yy1_ex</span>, breaks<span class="op">=</span><span class="fl">20</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">400</span>, <span class="fl">2600</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkhi-1.png" width="672"></p>
<p>The probability density function for a
continuous random variable <span class="math inline">\(X\)</span> satisfies</p>
<p><span class="math display">\[
\int_a^b f(x) dx = \mbox{Pr}(a &lt; X &lt; b)
\]</span></p>
<p>We can estimate the density function for a
sample in various ways. Here is a simple
illustration:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/density.html" class="external-link">density</a></span><span class="op">(</span><span class="va">yy1_ex</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkden-1.png" width="672"></p>
<p>It is of some interest to use <code>approxfun</code> and numerical
integration with the density estimate given above,
to estimate the probability that YY1
expression lies in a given interval.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dfun</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approxfun</a></span><span class="op">(</span><span class="va">dd</span><span class="op">$</span><span class="va">x</span>, <span class="va">dd</span><span class="op">$</span><span class="va">y</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">dfun</span>, <span class="fl">1000</span>, <span class="fl">1500</span><span class="op">)</span>  <span class="co"># density-based</span></code></pre></div>
<pre><code><span class="co">## 0.4821651 with absolute error &lt; 1e-05</span></code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">yy1_ex</span> <span class="op">&gt;=</span><span class="fl">1000</span> <span class="op">&amp;</span> <span class="va">yy1_ex</span> <span class="op">&lt;=</span> <span class="fl">1500</span><span class="op">)</span> <span class="co"># empirical</span></code></pre></div>
<pre><code><span class="co">## [1] 0.5316456</span></code></pre>
<p>Is this acceptable? Could changing the bandwidth for the
density estimator produce better results? Is there
a potential overfitting problem?</p>
</div>
<div class="section level4">
<h4 id="some-widely-used-models-for-continuous-responses">Some widely used models for continuous responses<a class="anchor" aria-label="anchor" href="#some-widely-used-models-for-continuous-responses"></a>
</h4>
<p>We’ll use simulation to illustrate the shapes of
various distributions. R makes this very simple with
a family of functions whose names begin with <code>r</code>.</p>
<div class="section level5">
<h5 id="uniform-distribution-on-01">Uniform distribution on [0,1]<a class="anchor" aria-label="anchor" href="#uniform-distribution-on-01"></a>
</h5>
<p>The density function is <span class="math inline">\(f(x) = 1\)</span> if <span class="math inline">\(x \in [0,1]\)</span> and 0 otherwise.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkunif-1.png" width="672"></p>
<div class="section level6">
<h6 id="exercise-3">Exercise<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h6>
<p><strong>17: Use code like that above to obtain
the value of the density of a random
variable with uniform density on the interval [0, 2].</strong></p>
</div>
</div>
<div class="section level5">
<h5 id="gaussian-model">Gaussian model<a class="anchor" aria-label="anchor" href="#gaussian-model"></a>
</h5>
<p>The Gaussian distribution is also called “normal”.
Its shape and position on the real line are determined
by its mean and variance. Symbolically,
the model is often written <span class="math inline">\(N(\mu, \sigma^2)\)</span>, and
the density function is
<span class="math inline">\(f(x) = 1/\sqrt{2\pi \sigma^2} \exp\{(x-\mu)^2/2 \sigma^2\}\)</span>.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, prob<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span>,len<span class="op">=</span><span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span>,<span class="fl">4</span>,len<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lknorm-1.png" width="672"></p>
</div>
<div class="section level5">
<h5 id="exponential-and-gamma-models-for-survival-data">Exponential and Gamma models for survival data<a class="anchor" aria-label="anchor" href="#exponential-and-gamma-models-for-survival-data"></a>
</h5>
<p>The exponential model (not to be confused with
exponential family models) is defined for random
variables with positive values. An example
is survival times. We’ll use a dataset from the survival
package to illustrate.</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span> <span class="co"># use myeloma records from Mayo clinic, remove censored times</span>
<span class="va">md</span> <span class="op">=</span> <span class="va">myeloma</span><span class="op">$</span><span class="va">futime</span><span class="op">[</span><span class="va">myeloma</span><span class="op">$</span><span class="va">death</span><span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">myeloma</span><span class="op">$</span><span class="va">entry</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">md</span>, breaks<span class="op">=</span><span class="fl">20</span>, prob<span class="op">=</span><span class="cn">TRUE</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.001</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">md</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 1044.768</span></code></pre>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ss</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8000</span>,<span class="fl">.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ss</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">dexp</a></span><span class="op">(</span><span class="va">ss</span>, rate<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">md</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkmd-1.png" width="672"></p>
<p>The density function for the exponential model is <span class="math inline">\(f(x) = \lambda e ^ {-\lambda x}\)</span>.
In this formulation, <span class="math inline">\(\lambda\)</span> is referred to as the rate parameter. The
mean of the distribution is then <span class="math inline">\(1/\lambda\)</span>.</p>
<div class="section level6">
<h6 id="exercise-4">Exercise<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h6>
<p><strong>18: How close is the median of the exponential model
with rate 1/1045 to the sample median of the myeloma
survival times? How does this relate to the interpretation of
the plot above?</strong></p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="mean-and-variance-for-continuous-models">Mean and variance for continuous models<a class="anchor" aria-label="anchor" href="#mean-and-variance-for-continuous-models"></a>
</h3>
<p>For continuous distributions, the mean value is
<span class="math display">\[
E(x) = \int x f(x) dx.
\]</span>
Writing <span class="math inline">\(\mu\)</span> for the mean value of the distribution
under study, the variance of a continuous distribution
is
<span class="math display">\[
V(x) = \int (x-\mu)^2 f(x) dx.
\]</span></p>
</div>
<div class="section level3">
<h3 id="multivariate-response">Multivariate response<a class="anchor" aria-label="anchor" href="#multivariate-response"></a>
</h3>
<p>We’ve seen that the use of univariate probability models has
many facets.
The concept of <em>joint distribution</em> of <em>multiple</em> random quantities
is central to reasoning about interactions among components
of complicated processes.</p>
<p>In the following example, we have obtained normalized expression measures
for EGR1 and FOS in adrenocortical carcinoma tumors studied
in TCGA. We’ll use built-in bivariate density estimation to
show the relationship between expression of these two
transcription factors in ACC.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span>
<span class="va">bivdf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">fos_ex</span>, <span class="va">egr1_ex</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bivdf</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="external-link">geom_density_2d</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkcont-1.png" width="672"></p>
<div class="section level4">
<h4 id="joint-cumulative-distribution-function">Joint cumulative distribution function<a class="anchor" aria-label="anchor" href="#joint-cumulative-distribution-function"></a>
</h4>
<p>We’ll focus on the case of continuous bivariate response denoted <span class="math inline">\((X,Y)\)</span>. The joint cumulative
distribution function (cdf) is
<span class="math display">\[
F(x,y) = Pr(X &lt; x, Y &lt; y)
\]</span>
So, for log FOS and log EGR1, we can evaluate <span class="math inline">\(F(7,7)\)</span> as follows:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">7</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">7</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.278481</span></code></pre>
<p>We will call this the empirical estimate of <span class="math inline">\(F(7,7)\)</span>.</p>
</div>
<div class="section level4">
<h4 id="covariance-matrix-bivariate-case">Covariance matrix, bivariate case<a class="anchor" aria-label="anchor" href="#covariance-matrix-bivariate-case"></a>
</h4>
<p>The covariance between two random variables is <span class="math inline">\(Cov(X,Y) = EXY - (EX)(EY)\)</span>;
the covariance matrix is symmetric, has the variances on the diagonal,
and the covariance off the diagonal.</p>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span><span class="op">)</span> <span class="co"># univariate</span></code></pre></div>
<pre><code><span class="co">## [1] 1.194019</span></code></pre>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">covmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># matrix</span>
<span class="va">covmat</span></code></pre></div>
<pre><code><span class="co">##           [,1]      [,2]</span>
<span class="co">## [1,] 1.1940188 0.9746936</span>
<span class="co">## [2,] 0.9746936 1.4137188</span></code></pre>
</div>
<div class="section level4">
<h4 id="using-the-bivariate-normal-model">Using the bivariate normal model<a class="anchor" aria-label="anchor" href="#using-the-bivariate-normal-model"></a>
</h4>
<p>Given estimates of the bivariate mean and covariance, we can use
the multivariate normal cumulative density function to produce
contours of the distribution that will have elliptical shapes,
as opposed to the wiggly contours we saw above.</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bmean</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span>
<span class="va">xgrid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">10</span>,<span class="fl">.05</span><span class="op">)</span>
<span class="va">ygrid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">10</span>,<span class="fl">.05</span><span class="op">)</span>
<span class="va">ngrid</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xgrid</span><span class="op">)</span>
<span class="va">nd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">ngrid</span>, <span class="va">ngrid</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngrid</span><span class="op">)</span> <span class="op">{</span>  <span class="co"># inefficient!</span>
 <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ngrid</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">nd</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">dmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">xgrid</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>,<span class="va">ygrid</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>, <span class="va">bmean</span>, <span class="va">covmat</span><span class="op">)</span>
  <span class="op">}</span>
 <span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">xgrid</span>, <span class="va">ygrid</span>, <span class="va">nd</span>, ylab<span class="op">=</span><span class="st">"log EGR1"</span>, xlab<span class="op">=</span><span class="st">"log FOS"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fos_ex</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">egr1_ex</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"gray"</span>, pch<span class="op">=</span><span class="fl">19</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/getdf-1.png" width="672"></p>
<p>The estimate of <span class="math inline">\(F(7,7)\)</span> using this model is</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/pmvnorm.html" class="external-link">pmvnorm</a></span><span class="op">(</span>upper<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>,<span class="fl">7</span><span class="op">)</span>, mean<span class="op">=</span><span class="va">bmean</span>, sigma<span class="op">=</span><span class="va">covmat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.3368775</span>
<span class="co">## attr(,"error")</span>
<span class="co">## [1] 1e-15</span>
<span class="co">## attr(,"msg")</span>
<span class="co">## [1] "Normal Completion"</span></code></pre>
<p>We’ll call this the model-based estimate of <span class="math inline">\(F(7,7)\)</span>.</p>
<div class="section level5">
<h5 id="exercise-5">Exercise<a class="anchor" aria-label="anchor" href="#exercise-5"></a>
</h5>
<p><strong>19: Obtain empirical and model-based estimates of <span class="math inline">\(F(6,5)\)</span>
for (log FOS, log EGR1).</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="probabilistic-independence-and-dependence">Probabilistic independence and dependence<a class="anchor" aria-label="anchor" href="#probabilistic-independence-and-dependence"></a>
</h4>
<p>The “tilted contour ellipses” shown just above indicate that
knowledge of the value of log FOS tells us about variation in values
of log EGR1. If log FOS is 6, the value of log EGR1 is much more likely
to be around 6 than it is to be around 9. We use the concept of
conditional distribution to address this concept, and denote this
conditional distribution function <span class="math inline">\(F(x|y)\)</span>, with the vertical bar
denoting conditioning. Specifically,
<span class="math inline">\(F(x|Y=y)\)</span> = Pr(<span class="math inline">\(X&lt;x\)</span>) <strong>given that</strong> <span class="math inline">\(Y = y\)</span>.</p>
<p>Probabilistic independence of two random quantities can be formulated
as the condition that <span class="math inline">\(F(x|y) = F(x)\)</span>: knowledge of the value of <span class="math inline">\(Y\)</span>
provides no information on the distribution of <span class="math inline">\(X\)</span>.</p>
</div>
<div class="section level4">
<h4 id="measures-of-correlation">Measures of correlation<a class="anchor" aria-label="anchor" href="#measures-of-correlation"></a>
</h4>
<p>The correlation coefficient for two random quantities is the ratio of
their covariance to the square root of the product of their variances.</p>
<p><strong>20: Use the elements of covmat computed above to produce
an estimate of the correlation between log FOS and log EGR1, and
compare to cor() in R for (log FOS, log EGR1).</strong></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
